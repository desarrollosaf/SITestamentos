<div class="row">
  <div class="col-lg-12 grid-margin stretch-card">
    <div class="card">
      <div class="card-body">
        <h4 class="card-title">Solicitudes enviadas</h4>
        <!--<p class="text-secondary mb-3">Add class <code>.table-striped</code></p>-->
        <!-- Tabla de solicitudes -->
        <div class="table-responsive">
          <table class="table table-striped">
            <thead>
              <tr>
                <th></th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Registradas hasta el: {{ this.dependencias.fechaactual }}</td>
                <td>{{ this.dependencias.total }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <br>
        <p class="text-secondary mb-3">Por favor, seleccione una dependencia y defina un rango de fechas para visualizar la gráfica.</p>
        <div class="row">

        <!-- Columna 1: ng-select -->
        <div class="col-md-6 mb-3">
            <ng-select 
              [items]="dependencias.dependencias"
              bindLabel="Nombre"
              bindValue="id_Dependencia"
              [searchable]="false"
              [(ngModel)]="selectedPersonId">
            </ng-select>

            <!--<p class="mt-2 text-secondary">
            Selected item: <span class="fw-bolder">{{ selectedPersonId }}</span>
            </p>-->
        </div>

        <!-- Columna 2: formulario de fechas (sin cambiar nada) -->
        <div class="col-md-6 mb-3">
            <form class="d-flex range-selection">
            <div class="form-group hidden">
                <div class="input-group">
                <input name="datepicker"
                        class="form-control"
                        ngbDatepicker
                        #datepicker="ngbDatepicker"
                        [autoClose]="'outside'"
                        (dateSelect)="onDateSelection($event)"
                        [displayMonths]="2"
                        [dayTemplate]="t"
                        outsideDays="hidden"
                        [startDate]="fromDate!">
                <ng-template #t let-date let-focused="focused">
                    <span class="custom-day"
                        [class.focused]="focused"
                        [class.range]="isRange(date)"
                        [class.faded]="isHovered(date) || isInside(date)"
                        (mouseenter)="hoveredDate = date"
                        (mouseleave)="hoveredDate = null">
                    {{ date.day }}
                    </span>
                </ng-template>
                </div>
            </div>

            <!-- Fecha desde -->
            <div class="mb-3">
                <div class="input-group" (click)="datepicker.toggle()">
                <input #dpFromDate
                        class="form-control"
                        placeholder="yyyy-mm-dd"
                        name="dpFromDate"
                        [value]="formatter.format(fromDate)"
                        (input)="fromDate = validateInput(fromDate, dpFromDate.value)">
                <button class="input-group-text" type="button">
                    <i class="feather icon-calendar icon-md text-secondary"></i>
                </button>
                </div>
            </div>

            <!-- Fecha hasta -->
            <div class="ms-2">
                <div class="input-group" (click)="datepicker.toggle()">
                <input #dpToDate
                        class="form-control"
                        placeholder="yyyy-mm-dd"
                        name="dpToDate"
                        [value]="formatter.format(toDate)"
                        (input)="toDate = validateInput(toDate, dpToDate.value)">
                <button class="input-group-text" type="button">
                    <i class="feather icon-calendar icon-md text-secondary"></i>
                </button>
                </div>
            </div>
           
           
            </form>
              
          </div>
          
        </div>

        <!--<p class="mt-3 text-secondary">From: {{ fromDate | json }}</p>
        <p class="text-secondary">To: {{ toDate | json }}</p>
         Contenedor del gráfico centrado -->
        @if(this.graficaGenerada){
          <div class="row justify-content-center mt-5">
            <div class="col-md-12">
              <h6 class="card-title"></h6>

              <canvas baseChart
              [data]="lineChartData"
              [options]="lineChartOptions"
              [type]="lineChartType"
              [plugins]="lineChartPlugins">
              </canvas>
            </div>
          </div>
        }
        

      </div>
    </div>
  </div>
</div>
